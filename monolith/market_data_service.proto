syntax = "proto3";

package hub_investments;

import "common/common.proto";

option go_package = "github.com/RodriguesYan/hub-proto-contracts/monolith";

// ====================================
// MARKET DATA SERVICE
// ====================================

// MarketDataService provides market data operations
service MarketDataService {
  // GetMarketData retrieves market data for a specific symbol
  rpc GetMarketData(GetMarketDataRequest) returns (GetMarketDataResponse);
  // GetAssetDetails retrieves detailed asset information
  rpc GetAssetDetails(GetAssetDetailsRequest) returns (GetAssetDetailsResponse);
  // GetBatchMarketData retrieves market data for multiple symbols
  rpc GetBatchMarketData(GetBatchMarketDataRequest) returns (GetBatchMarketDataResponse);
  // StreamQuotes streams real-time quote updates for subscribed symbols
  rpc StreamQuotes(stream StreamQuotesRequest) returns (stream StreamQuotesResponse);
}

// ====================================
// MARKET DATA SERVICE MESSAGES
// ====================================

message GetMarketDataRequest {
  string symbol = 1;
}

message GetMarketDataResponse {
  APIResponse api_response = 1;
  MarketData market_data = 2;
}

message GetAssetDetailsRequest {
  string symbol = 1;
}

message GetAssetDetailsResponse {
  APIResponse api_response = 1;
  AssetDetails asset = 2;
}

message GetBatchMarketDataRequest {
  repeated string symbols = 1;
}

message GetBatchMarketDataResponse {
  APIResponse api_response = 1;
  repeated MarketData market_data = 2;
}

message MarketData {
  string symbol = 1;
  string company_name = 2;
  double current_price = 3;
  double previous_close = 4;
  double open_price = 5;
  double high_price = 6;
  double low_price = 7;
  double change = 8;
  double change_percent = 9;
  int64 volume = 10;
  string last_updated = 11;
  int32 category = 12;
}

message AssetDetails {
  string symbol = 1;
  string company_name = 2;
  string sector = 3;
  string industry = 4;
  string description = 5;
  double market_cap = 6;
  double pe_ratio = 7;
  double dividend_yield = 8;
  double fifty_two_week_high = 9;
  double fifty_two_week_low = 10;
  string currency = 11;
  string exchange = 12;
}

// ====================================
// STREAMING QUOTES MESSAGES
// ====================================

message StreamQuotesRequest {
  string action = 1;           // "subscribe" or "unsubscribe"
  repeated string symbols = 2; // List of symbols to subscribe/unsubscribe
}

message StreamQuotesResponse {
  string type = 1;              // "quote", "error", "heartbeat"
  AssetQuote quote = 2;         // Quote data (only for type="quote")
  string error_message = 3;     // Error message (only for type="error")
}

message AssetQuote {
  string symbol = 1;
  string name = 2;
  string asset_type = 3;        // "STOCK" or "ETF"
  double current_price = 4;
  double base_price = 5;
  double change = 6;
  double change_percent = 7;
  string last_updated = 8;
  int64 volume = 9;
  int64 market_cap = 10;
}

